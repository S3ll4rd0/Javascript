<!DOCTYPE html>
<html lang="es">
<head>
<title>ajax2-ejemplo01</title>
<script>
var ajax;
window.addEventListener("load",inicia,false)

function inicia(){
   var obj=document.getElementById("boton");
   obj.addEventListener("click",solAjax,false);
}

function solAjax(){
   ajax=new XMLHttpRequest();//Instanciamos XHR
   ajax.addEventListener("load",mostrar,false); //Se lanza al completarse con éxito
   ajax.addEventListener("loadend",final,false);//Se lanza al completar la solicitud
   ajax.addEventListener("readystatechange",cambio,false);//Se lanza cuando cambia el valor de la propiedad readyState
   ajax.open("GET","documento.txt",true);//Método GET, recupera el fichero documento.txt
   ajax.send();//Método SEND, como es GET está vacío. Inicia la solicitud AJAX
}

function mostrar(e){
   var v_resultado=document.getElementById("resultado");
   v_resultado.innerText=e.target.responseText;
    
}

function cambio(e){
   console.log("Se ha detectado un cambio de estado: " + ajax.readyState);//Con readyState nos devuelve del 1 al 4 dependiendo del número del estado.
}
function final(){
   alert("todo finalizado");
}
</script>

</head>
<body>
<section id="peticion">
<button id="boton">Pulsar</button>
</section>
<section id="resultado">
</section>
</body>
</html>
